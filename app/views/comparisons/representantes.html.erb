<p id="notice"><%= notice %></p>

<h3>NÃºmero de afiliados</h3>
<div class="row">
<%= form_tag comparisons_path, :method => :get do |f| %>
  <%= select_tag :fecha_datos, options_for_select(@fechas_datos), prompt: "Seleccionar Fecha", onchange: "this.form.submit();"  %>

  <%= select_tag :region, options_for_select(@regiones_datos), prompt: "Seleccionar Region"  %>

<% end %>
</div>
<%=  @datos.to_json.html_safe %>
<div class="row">
  <table class="table">
    <thead>
      <tr>
        <td>
          Partido
        </td>
        <td>
          Representantes
        </td>
        <td>

        </td>
      </tr>
    </thead>
    <tbody>
      <% @datos.each_with_index do |linea, i| %>
      <tr>
        <div id='header'></div>
      </tr>
      <tr>
        <td>
          <%= linea[:partido][:sigla] %>
        </td>
        <td>
          <% linea[:representantes].each_with_index do |r, j| %>
            <tr>
              <td>
                <%= r %>
              </td>
            </tr>
          <% end %>
        </td>
        <td>

        </td>
      </tr>
      <% end %>
    </tbody>
  </table>

</div>

<div id="barras"></div>

<br>
<script>
$(document).ready(function(){
  var data = <%=  @datos.to_json.html_safe %>;
  var data_totals = <%=  @datos_totals.to_json.html_safe %>;
  var fechas = <%=  @fechas_datos.to_json.html_safe %>;
  var fecha_seleccionada =  <%=  @fecha.to_json.html_safe %>;
     //Raphael("barras",800, 800 ).afiliados_compare_chart(data, data_totals);
     Raphael("header",400, 40 ).afiliados_compare_header();
     for(var i=0; i < data.length; i++){
       Raphael("barras_" + i,300, 30 ).afiliados_compare_bar(data[i]);
     }

});
</script>
